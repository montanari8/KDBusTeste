<!DOCTYPE html>
<html>

<head>
    <title>Simulador de Ônibus com Leaflet</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map {
            height: 600px;
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <div id="message"></div>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>


        const coordenadas = [
            [-23.58145, -48.03186],
            [-23.58184, -48.03173],
            [-23.58181, -48.03152],
            [-23.5829, -48.03331],
            [-23.58295, -48.03327],
            [-23.58332, -48.03302],
            [-23.58342, -48.03292],
            [-23.5835, -48.03284],
            [-23.58353, -48.03279],
            [-23.58357, -48.03272],
            [-23.58363, -48.03258],
            [-23.5837, -48.03247],
            [-23.58372, -48.03245],
            [-23.58373, -48.03242],
            [-23.58375, -48.03241],
            [-23.58378, -48.0324],
            [-23.5838, -48.03239],
            [-23.58425, -48.03223],
            [-23.58451, -48.03214],
            [-23.58459, -48.03211],
            [-23.58536, -48.03186],
            [-23.58566, -48.03175],
            [-23.58642, -48.03144],
            [-23.58679, -48.03127],
            [-23.58707, -48.03114],
            [-23.58716, -48.03107],
            [-23.58727, -48.03095],
            [-23.58768, -48.03057],
            [-23.58781, -48.03045],
            [-23.58782, -48.03044],
            [-23.58796, -48.03032],
            [-23.58809, -48.03019],
            [-23.58823, -48.03006],
            [-23.58837, -48.02994],
            [-23.5889, -48.02944],
            [-23.58912, -48.02929],
            [-23.58921, -48.02923],
            [-23.58923, -48.0292],
            [-23.58924, -48.02921],
            [-23.58925, -48.02922],
            [-23.58926, -48.02922],
            [-23.58927, -48.02922],
            [-23.58928, -48.02923],
            [-23.58929, -48.02923],
            [-23.5893, -48.02923],
            [-23.58931, -48.02923],
            [-23.58932, -48.02923],
            [-23.58933, -48.02923],
            [-23.58934, -48.02923],
            [-23.58935, -48.02922],
            [-23.58936, -48.02922],
            [-23.58937, -48.02922],
            [-23.58937, -48.02921],
            [-23.58938, -48.02921],
            [-23.58939, -48.0292],
            [-23.5894, -48.02919],
            [-23.58941, -48.02919],
            [-23.58942, -48.02917],
            [-23.58943, -48.02916],
            [-23.58944, -48.02914],
            [-23.58945, -48.02913],
            [-23.58946, -48.02911],
            [-23.58947, -48.0291],
            [-23.58948, -48.02909],
            [-23.58949, -48.02907],
            [-23.5895, -48.02904],
            [-23.5895, -48.029],
            [-23.5895, -48.02897],
            [-23.5895, -48.02894],
            [-23.5895, -48.0289],
            [-23.5895, -48.02887],
            [-23.5895, -48.02883],
            [-23.5895, -48.0288],
            [-23.58954, -48.0287],
            [-23.58954, -48.02866],
            [-23.58954, -48.02865],
            [-23.58954, -48.02862],
            [-23.58954, -48.02859],
            [-23.58959, -48.0284],
            [-23.58966, -48.02824],
            [-23.58986, -48.02775],
            [-23.59022, -48.02668],
            [-23.59036, -48.02622],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59044, -48.026],
            [-23.59055, -48.02566],
            [-23.59063, -48.02542],
            [-23.59068, -48.02521],
            [-23.59069, -48.02516],
            [-23.59073, -48.0251],
            [-23.59075, -48.02506],
            [-23.59078, -48.02499],
            [-23.59086, -48.02477],
            [-23.59089, -48.02471],
            [-23.59098, -48.02461],
            [-23.59102, -48.02445],
            [-23.59104, -48.02443],
            [-23.59105, -48.02443],
            [-23.59107, -48.02442],
            [-23.59108, -48.02441],
            [-23.59109, -48.0244],
            [-23.5911, -48.02438],
            [-23.59111, -48.02437],
            [-23.59112, -48.02436],
            [-23.59112, -48.02435],
            [-23.59113, -48.02433],
            [-23.59114, -48.02432],
            [-23.59114, -48.0243],
            [-23.59114, -48.02428],
            [-23.59114, -48.02427],
            [-23.59114, -48.02425],
            [-23.59114, -48.02423],
            [-23.59121, -48.02401],
            [-23.59125, -48.02383],
            [-23.59147, -48.02361],
            [-23.59166, -48.02347],
            [-23.59194, -48.02327],
            [-23.59213, -48.02314],
            [-23.59231, -48.023],
            [-23.59233, -48.02298],
            [-23.59244, -48.02288],
            [-23.59257, -48.02277],
            [-23.59286, -48.0224],
            [-23.59288, -48.02236],
            [-23.59295, -48.02223],
            [-23.59298, -48.02219],
            [-23.59308, -48.02202],
            [-23.59354, -48.02119],
            [-23.59375, -48.02074],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59383, -48.02056],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59384, -48.02053],
            [-23.59387, -48.02046],
            [-23.59402, -48.02019],
            [-23.59419, -48.01989],
            [-23.59429, -48.01972],
            [-23.59457, -48.01922],
            [-23.59461, -48.01915],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59468, -48.01904],
            [-23.59473, -48.01894],
            [-23.59514, -48.01821],
            [-23.59521, -48.01815],
            [-23.59527, -48.01807],
            [-23.59529, -48.01805],
            [-23.5953, -48.01802],
            [-23.59539, -48.01789],
            [-23.59545, -48.0178],
            [-23.59564, -48.01748],
            [-23.59574, -48.01731],
            [-23.59579, -48.01718],
            [-23.59588, -48.01705],
            [-23.59593, -48.01696],
            [-23.59599, -48.01696],
            [-23.59602, -48.01696],
            [-23.59607, -48.01698],
            [-23.59618, -48.01703],
            [-23.59627, -48.01711],
            [-23.59635, -48.01718],
            [-23.59641, -48.01724],
            [-23.59647, -48.01731],
            [-23.59654, -48.0174],
            [-23.5966, -48.01752],
            [-23.59664, -48.01761],
            [-23.59667, -48.01768],
            [-23.59669, -48.01779],
            [-23.59671, -48.01786],
            [-23.59673, -48.0181],
            [-23.59677, -48.01857],
            [-23.59677, -48.01876],
            [-23.59677, -48.01878],
            [-23.59681, -48.01972],
            [-23.59687, -48.02],
            [-23.59694, -48.0202],
            [-23.59699, -48.02081],
            [-23.59706, -48.02196],
            [-23.59707, -48.02216],
            [-23.59711, -48.02275],
            [-23.59712, -48.02328],
            [-23.59714, -48.02381],
            [-23.59717, -48.02429],
            [-23.59719, -48.02477],
            [-23.59726, -48.02611],
            [-23.59734, -48.02787],
            [-23.59738, -48.02838],
            [-23.59737, -48.02859],
            [-23.59736, -48.0288]
        ];


        // Coordenadas do proximidade fixo (exemplo: posição do passageiro)
        var latFixo = -23.593798331228253;
        var lonFixo = -48.01770304206565;

        // Coordenadas do proximidade de ônibus
        var proximidadeOnibus = { 'lat': -23.59468, 'lon': -48.01904 }

        // Inicializar o mapa
        const map = L.map('map').setView(coordenadas[0], 15);

        // Adicionar a camada de mapa
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Adicionando marcador para o proximidade fixo (passageiro)
        var markerFixo = L.marker([latFixo, lonFixo]).addTo(map)
            .bindPopup('Posição do Passageiro');

        // Adicionar o marcador do ônibus
        const busMarker = L.marker(coordenadas[0]).addTo(map);

        // Função para mover o ônibus pelas coordenadas
        let index = 0;

        function moveBus() {
            if (index < coordenadas.length - 1) {
                const [lat1, lon1] = coordenadas[index];
                const [lat2, lon2] = coordenadas[index + 1];
                const distance = map.distance([lat1, lon1], [lat2, lon2]);
                const duration = (distance / 50) * 1000; // Velocidade do ônibus: 50 m/s

                busMarker.setLatLng([lat1, lon1]);
                const animation = L.DomUtil.create('div', 'leaflet-zoom-animated');
                L.DomUtil.setPosition(animation, map.latLngToLayerPoint([lat2, lon2]));

                L.Util.requestAnimFrame(function () {
                    L.DomUtil.setPosition(animation, map.latLngToLayerPoint([lat2, lon2]));
                    busMarker.setLatLng([lat2, lon2]);
                    map.panTo([lat2, lon2]);


                }, null, false, duration);

                //atualizar a mensagem de distância
                updateDistance(lat2, lon2);


                index++;
                setTimeout(moveBus, duration);
            }
        }

        // Função para calcular a distância entre dois proximidades usando Haversine
        function calcularDistancia(lat1, lon1, lat2, lon2) {
            var R = 6371000; // Raio da Terra em metros
            var φ1 = lat1 * Math.PI / 180;
            var φ2 = lat2 * Math.PI / 180;
            var Δφ = (lat2 - lat1) * Math.PI / 180;
            var Δλ = (lon2 - lon1) * Math.PI / 180;

            var a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +
                Math.cos(φ1) * Math.cos(φ2) *
                Math.sin(Δλ / 2) * Math.sin(Δλ / 2);
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

            var distancia = R * c;
            return distancia;
        }
        /*
                // Função para atualizar a mensagem de distância
                function updateDistance(lat2, lon2) {
                    var latBus = lat2;
                    var lonBus = lon2;
        
                    var distancia = calcularDistancia(latFixo, lonFixo, latBus, lonBus);
        
                    var message = document.getElementById('message');
        
                    if (distancia <= 1000) {
                        message.innerHTML = "O ônibus está a 1 km ou menos da posição do passageiro.";
                    } else {
                        message.innerHTML = "O ônibus está a mais de 1 km da posição do passageiro.";
                    }
                }
        
               */

        // Função para atualizar a mensagem de distância e enviar notificação
        /*
        function updateDistance(lat2, lon2) {
            var latBus = lat2;
            var lonBus = lon2;

            var distancia = calcularDistancia(latFixo, lonFixo, latBus, lonBus);

            var message = document.getElementById('message');

            if (distancia <= 1000) {
                message.innerHTML = "O ônibus está a 1 km ou menos da posição do passageiro.";
                // Verifica se o navegador suporta notificações
                if ('Notification' in window) {
                    // Solicita permissão para enviar notificações
                    Notification.requestPermission().then(function (permission) {
                        if (permission === 'granted') {
                            // Cria e exibe a notificação
                            var notification = new Notification('Ônibus Próximo', {
                                body: 'O ônibus está a 1 km ou menos da sua posição.'
                            });
                        }
                    });
                }
            } else {
                message.innerHTML = "O ônibus está a mais de 1 km da posição do passageiro.";
            }
        }

*/

        // Variáveis para controlar a posição anterior do ônibus e o estado do proximidade
        var posicaoAnterior = null;
        var passouPeloPonto = false;
        var proximidade = false;


        // Função para atualizar a mensagem de distância e enviar notificação
        function updateDistance(lat2, lon2) {
            var latBus = lat2;
            var lonBus = lon2;



            // Verifica se já há uma posição anterior registrada
            if (posicaoAnterior === null) {
                posicaoAnterior = { lat: latBus, lon: lonBus };
                return; // Não faz nada na primeira execução
            }

            // Calcula a distância percorrida desde a última verificação
            var distanciaPercorrida = calcularDistancia(posicaoAnterior.lat, posicaoAnterior.lon, latBus, lonBus);

            // Calcula a distância entre o ônibus e o proximidade de ônibus
            distanciaproximidadeOnibus = calcularDistancia(proximidadeOnibus.lat, proximidadeOnibus.lon, latBus, lonBus);
            console.log('A distância do ônibus em relação ao proximidade de ônibos é: ' + distanciaproximidadeOnibus);

            // Calcula a distância atual do ônibus ao proximidade do passageiro
            var distancia = calcularDistancia(latFixo, lonFixo, latBus, lonBus);
            var distanciaArredondada = Math.floor(distancia); // Arredonda para baixo para remover casas decimais

            var message = document.getElementById('message');

            // Verifica se a distância é menor ou igual a 200 metros e se proximidade é false
            if (distanciaArredondada <= 200 && !passouPeloPonto) {
                message.innerHTML = "O ônibus está a 200 metros ou menos da posição do passageiro.";
            }

            console.log(distanciaArredondada, distanciaPercorrida);

            // condição proximidade de ônibus
            if (distanciaproximidadeOnibus < 50) {
                message.innerHTML = "O ônibus está no ponto de ônibus.";
                if ('Notification' in window && !passouPeloPonto) {
                    Notification.requestPermission().then(function (permission) {
                        if (permission === 'granted') {
                            var notification = new Notification('Ônibus Próximo', {
                                body: "O ônibus está no ponto de ônibus."
                            });
                        }
                    });
                }
                passouPeloPonto = true; // Marca que o ônibus passou próximo ao proximidade do passageiro
                return; // Encerra a função aqui para não continuar mostrando ou notificando
            }

            // Verifica se a distância é menor ou igual a 3000 metros e proximidade é false
            if (distanciaArredondada <= 3000 && !proximidade && !passouPeloPonto) {
                // Verifica se o ônibus se moveu pelo menos 500 metros desde a última notificação
                if (distanciaPercorrida >= 500) {
                    // Atualiza a posição anterior para a atual
                    posicaoAnterior = { lat: latBus, lon: lonBus };
                    // Envia a notificação
                    if ('Notification' in window) {
                        Notification.requestPermission().then(function (permission) {
                            if (permission === 'granted') {
                                var notification = new Notification('Ônibus Próximo', {
                                    body: 'O ônibus está a ' + distanciaArredondada + ' metros da sua posição.'
                                });
                            }
                        });
                    }
                }

                // Define a mensagem padrão de distância
                message.innerHTML = "O ônibus está a " + distanciaArredondada + " metros da posição do passageiro.";
            }
            else if (distanciaproximidadeOnibus > 50 && distanciaproximidadeOnibus <= 100) {
                message.innerHTML = "O ônibus já passou pelo ponto de ônibus.";
                posicaoAnterior = { lat: latBus, lon: lonBus };
                // Envia a notificação
                if ('Notification' in window) {
                    Notification.requestPermission().then(function (permission) {
                        if (permission === 'granted') {
                            var notification = new Notification('Ônibus Próximo', {
                                body: 'O ônibus já passou pelo ponto e está a ' + distanciaArredondada + ' metros da sua posição.'
                            });
                        }
                    });
                }
                proximidade = false;
            }

            else if (distanciaArredondada > 200 && passouPeloPonto) {
                message.innerHTML = 'O ônibus está a mais de ' + distanciaArredondada + ' km da posição do passageiro.';
            }
        }






        // Iniciar o movimento do ônibus
        moveBus();
    </script>
</body>

</html>